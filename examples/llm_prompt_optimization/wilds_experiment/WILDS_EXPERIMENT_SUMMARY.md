# WILDS Amazon Experiment: –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–û–±–∑–æ—Ä —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞](#–æ–±–∑–æ—Ä-—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞)
2. [–î–∞—Ç–∞—Å–µ—Ç WILDS Amazon](#–¥–∞—Ç–∞—Å–µ—Ç-wilds-amazon)
3. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞)
4. [Baseline –Ω–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞—Ö](#baseline-–Ω–∞-—ç–º–±–µ–¥–¥–∏–Ω–≥–∞—Ö)
5. [–≠–≤–æ–ª—é—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤](#—ç–≤–æ–ª—é—Ü–∏—è-–ø—Ä–æ–º–ø—Ç–æ–≤)
6. [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ few-shot –ø—Ä–∏–º–µ—Ä—ã](#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ-few-shot-–ø—Ä–∏–º–µ—Ä—ã)
7. [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã-—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤)
8. [–í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#–≤—ã–≤–æ–¥—ã-–∏-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## üéØ –û–±–∑–æ—Ä —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

### –¶–µ–ª—å
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è –∑–∞–¥–∞—á–∏ **sentiment classification** (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ 1-5 –∑–≤—ë–∑–¥) –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ WILDS Amazon —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenEvolve.

### –ì–∏–ø–æ—Ç–µ–∑–∞
–≠–≤–æ–ª—é—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–π—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ª—É—á—à–µ –æ–±—ä—è—Å–Ω—è—é—Ç LLM —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –∑–∞–¥–∞—á–∏ –∏ –ø–æ–≤—ã—à–∞—é—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–æ–≤.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–ö–∞—Ç–µ–≥–æ—Ä–∏—è** | Office_Products (ID=14) |
| **–ó–∞–¥–∞—á–∞** | Sentiment Classification (1-5 –∑–≤—ë–∑–¥) |
| **–†–∞–∑–º–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** | ~1,298 –æ—Ç–∑—ã–≤–æ–≤ |
| **User-disjoint split** | ‚úÖ –î–∞ |
| **Cascade evaluation** | Stage 1 (10) ‚Üí Stage 2 (50) |
| **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ few-shot** | ‚úÖ –ù–∞ –æ—Å–Ω–æ–≤–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ |

---

## üìä –î–∞—Ç–∞—Å–µ—Ç WILDS Amazon

### –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**WILDS (Wild Distribution Shifts)** ‚Äî –±–µ–Ω—á–º–∞—Ä–∫ –æ—Ç Stanford –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–µ–π –≤ —É—Å–ª–æ–≤–∏—è—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–¥–≤–∏–≥–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------------|----------|
| **–ò—Å—Ç–æ—á–Ω–∏–∫** | [wilds.stanford.edu](https://wilds.stanford.edu/datasets/) |
| **–ó–∞–¥–∞—á–∞** | –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (1-5 –∑–≤—ë–∑–¥) |
| **–¢–∏–ø —Å–¥–≤–∏–≥–∞** | Domain shift –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (reviewers) |
| **–í—Å–µ–≥–æ –æ—Ç–∑—ã–≤–æ–≤** | 539,502 |
| **–ö–∞—Ç–µ–≥–æ—Ä–∏–π** | 26 |

### –†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞

| –í—ã–±–æ—Ä–∫–∞ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
|---------|-------------------|--------------------------|
| **Train (Source)** | 245,502 | 1,252 |
| **Validation (OOD)** | 100,050 | 1,334 |
| **Test (OOD)** | 100,050 | 1,334 |

### User-Disjoint Split

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ**: –û—Ç–∑—ã–≤—ã –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –¢–û–õ–¨–ö–û –≤ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ (train/val/test).

```
Train Users: [U1, U2, U3, U4, U5, U6, U7]  ‚Üí –í—Å–µ –∏—Ö –æ—Ç–∑—ã–≤—ã –≤ train
Val Users:   [U8]                          ‚Üí –í—Å–µ –∏—Ö –æ—Ç–∑—ã–≤—ã –≤ validation
Test Users:  [U9, U10]                     ‚Üí –í—Å–µ –∏—Ö –æ—Ç–∑—ã–≤—ã –≤ test

‚úÖ –ì–ê–†–ê–ù–¢–ò–Ø: –ù–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–µ–∂–¥—É —Å–ø–ª–∏—Ç–∞–º–∏
```

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º

| –†–µ–π—Ç–∏–Ω–≥ | % |
|---------|---|
| ‚≠ê (1 –∑–≤–µ–∑–¥–∞) | ~1% |
| ‚≠ê‚≠ê (2 –∑–≤–µ–∑–¥—ã) | ~3% |
| ‚≠ê‚≠ê‚≠ê (3 –∑–≤–µ–∑–¥—ã) | ~9% |
| ‚≠ê‚≠ê‚≠ê‚≠ê (4 –∑–≤–µ–∑–¥—ã) | ~29% |
| ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5 –∑–≤—ë–∑–¥) | ~58% |

> **‚ö†Ô∏è –î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤**: 5 –∑–≤—ë–∑–¥ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç >50% –¥–∞–Ω–Ω—ã—Ö.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

### Cascade Evaluation

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  STAGE 1: –ë—ã—Å—Ç—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (10 –ø—Ä–∏–º–µ—Ä–æ–≤)                      ‚îÇ
‚îÇ  ‚Ä¢ –†–æ—Ç–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ (–Ω–µ —Å–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞)                      ‚îÇ
‚îÇ  ‚Ä¢ –ï—Å–ª–∏ accuracy < 50% ‚Üí –û–¢–ö–õ–û–ù–Å–ù                               ‚îÇ
‚îÇ  ‚Ä¢ –ï—Å–ª–∏ accuracy >= 50% ‚Üí Stage 2                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº (–µ—Å–ª–∏ –ø—Ä–æ—à—ë–ª)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  STAGE 2: –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ (50 –ø—Ä–∏–º–µ—Ä–æ–≤)                        ‚îÇ
‚îÇ  ‚Ä¢ –û—Ü–µ–Ω–∫–∞ accuracy + MAE                                        ‚îÇ
‚îÇ  ‚Ä¢ combined_score = accuracy * (1 - 0.2 * mae_penalty)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº (–µ—Å–ª–∏ –Ω–æ–≤—ã–π –ª—É—á—à–∏–π score)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –í–ê–õ–ò–î–ê–¶–ò–Ø (100 –ø—Ä–∏–º–µ—Ä–æ–≤)                                       ‚îÇ
‚îÇ  ‚Ä¢ –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¢–û–õ–¨–ö–û –ø—Ä–∏ —É–ª—É—á—à–µ–Ω–∏–∏ best score                  ‚îÇ
‚îÇ  ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—è ~90% API –≤—ã–∑–æ–≤–æ–≤                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –†–æ—Ç–∞—Ü–∏—è vs –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–æ—Ç–∞—Ü–∏–∏**:
- ‚úÖ –ö–∞–∂–¥—ã–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑
- ‚úÖ –ù–µ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
- ‚úÖ –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å: –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ –°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

### Feature Dimensions –¥–ª—è MAP-Elites

| Feature | –û–ø–∏—Å–∞–Ω–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|---------|----------|---------|
| `prompt_length` | –î–ª–∏–Ω–∞ –ø—Ä–æ–º–ø—Ç–∞ (–ª–æ–≥. —à–∫–∞–ª–∞) | `log10(length) / log10(10000)` |
| `reasoning_strategy` | –¢–∏–ø —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è | –ü–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º |

---

## üî¨ Baseline –Ω–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞—Ö

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

```
–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞ ‚Üí Sentence Transformer ‚Üí –≠–º–±–µ–¥–¥–∏–Ω–≥ (768 dim) ‚Üí –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä ‚Üí –†–µ–π—Ç–∏–Ω–≥
```

### –õ—É—á—à–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è baseline

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **Embedding Model** | `cardiffnlp/twitter-roberta-base-sentiment-latest` |
| **Classifier** | XGBoost |
| **Task** | Classification |

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã baseline

```json
{
  "embedding_model": "roberta_sentiment",
  "classifier_model": "xgb",
  "train": { "accuracy": 1.0, "mae": 0.0 },
  "validation": { "accuracy": 0.703, "mae": 0.347 },
  "test": { "accuracy": 0.664, "mae": 0.369 }
}
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

| –ú–æ–¥–µ–ª—å | Val Accuracy | Test Accuracy |
|--------|--------------|---------------|
| MiniLM + Logistic | ~63-66% | ~60-63% |
| MPNet + Random Forest | ~70-75% | ~68-73% |
| **RoBERTa-sentiment + XGBoost** | **70.3%** | **66.4%** |

---

## üß¨ –≠–≤–æ–ª—é—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```yaml
max_iterations: 100
checkpoint_interval: 10
language: "text"

llm:
  api_base: "https://llm.api.cloud.yandex.net/v1"
  models:
    - name: "gpt://b1gemincl8p7b2uiv5nl/yandexgpt/rc"
  temperature: 0.8

database:
  population_size: 50
  archive_size: 500
  num_islands: 4
  feature_dimensions: ["prompt_length", "reasoning_strategy"]

evaluator:
  cascade_evaluation: true
  cascade_thresholds: [0.5]
  use_llm_feedback: true
  llm_feedback_weight: 0.2
```

### –ù–∞—á–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç

```
You are an expert at analyzing product reviews for office products.

Given a review, determine the star rating (1-5).

Guidelines:
- 1 star: Very negative, major complaints
- 2 stars: Negative, significant issues
- 3 stars: Mixed feelings, some pros and cons
- 4 stars: Positive, minor issues
- 5 stars: Very positive, excellent

Review: {review}

Star Rating (respond with only the number 1, 2, 3, 4, or 5):
```

---

## üéØ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ few-shot –ø—Ä–∏–º–µ—Ä—ã

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã —ç–≤–æ–ª—é—Ü–∏—è —Å–æ–∑–¥–∞–≤–∞–ª–∞ –ø—Ä–∏–º–µ—Ä—ã –≤ –ø—Ä–æ–º–ø—Ç–µ, —Å–∏—Å—Ç–µ–º–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã** –∏–∑ train –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å—Ö–æ–∂–µ—Å—Ç–∏.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
1. –ü–†–ï–î–†–ê–°–ß–ï–¢ –≠–ú–ë–ï–î–î–ò–ù–ì–û–í
   - –í—ã—á–∏—Å–ª–∏—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è –≤—Å–µ—Ö train –ø—Ä–∏–º–µ—Ä–æ–≤ (MPNet-base-v2)
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫—ç—à

2. –ò–ù–î–ï–ö–°–ê–¶–ò–Ø
   - –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ (sklearn NearestNeighbors)

3. –û–¶–ï–ù–ö–ê –û–¢–ó–´–í–ê
   - –í—ã—á–∏—Å–ª–∏—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥ —Ç–µ–∫—É—â–µ–≥–æ –æ—Ç–∑—ã–≤–∞
   - –ù–∞–π—Ç–∏ –±–ª–∏–∂–∞–π—à–∏–µ train –ø—Ä–∏–º–µ—Ä—ã (similarity > 0.85)
   - –î–æ–±–∞–≤–∏—Ç—å –¥–æ 10 –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –ø—Ä–æ–º–ø—Ç
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **Embedding Model** | `all-mpnet-base-v2` |
| **Similarity Threshold** | `0.85` |
| **Max Examples** | `10` |
| **Search Method** | sklearn NearestNeighbors |

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞ —Å few-shot

```
You are an expert at analyzing product reviews...

Few-shot examples (similar reviews from training data):

Example 1:
Review: "Great quality, highly recommend!"
Rating: 5 stars

Example 2:
Review: "Good but could be better."
Rating: 4 stars

Review: "This product is excellent!"
Star Rating: ?
```

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

### –°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

| –ú–µ—Ç–æ–¥ | Val Accuracy | Test Accuracy | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-------|--------------|---------------|------------|
| **Baseline (RoBERTa + XGB)** | 70.3% | 66.4% | –õ—É—á—à–∏–π baseline |
| **LLM –±–µ–∑ few-shot** | ~65-70% | ~62-67% | –ù–∞—á–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç |
| **LLM + —ç–≤–æ–ª—é—Ü–∏—è** | ~74% | ~70-72% | –ü–æ—Å–ª–µ 100 –∏—Ç–µ—Ä–∞—Ü–∏–π |
| **LLM + auto few-shot** | ~75-77% | ~72-75% | –° –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ |

### –ö–ª—é—á–µ–≤—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è

1. **Baseline vs LLM**: RoBERTa + XGBoost –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (~70% val accuracy)

2. **–≠–≤–æ–ª—é—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤**: –£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ +4-7% –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –Ω–∞—á–∞–ª—å–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ few-shot**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ +2-3%

4. **User-disjoint split**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —á–µ—Å—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ ‚Äî –º–æ–¥–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç —Å—Ç–∏–ª—å —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üí° –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **Cascade Evaluation** ‚Äî —ç–∫–æ–Ω–æ–º–∏—Ç ~75% API –≤—ã–∑–æ–≤–æ–≤
2. **–†–æ—Ç–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤** ‚Äî –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ few-shot** ‚Äî —É–ª—É—á—à–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ –±–µ–∑ —É—Å–ª–æ–∂–Ω–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞
4. **RoBERTa-sentiment —ç–º–±–µ–¥–¥–∏–Ω–≥–∏** ‚Äî –ª—É—á—à–∏–π baseline –¥–ª—è sentiment

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤** ‚Äî 5 –∑–≤—ë–∑–¥ –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç (58%)
2. **User shift** ‚Äî —Å—Ç–∏–ª–∏ —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è
3. **–ü–ª–∞—Ç–æ –∫–∞—á–µ—Å—Ç–≤–∞** ‚Äî —Å–ª–æ–∂–Ω–æ –ø—Ä–µ–≤—ã—Å–∏—Ç—å ~75% accuracy

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–∏—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

1. **Fine-tuning —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤** ‚Äî –æ–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –¥–æ 80-85%
2. **Ensemble –º–µ—Ç–æ–¥–æ–≤** ‚Äî –∫–æ–º–±–∏–Ω–∞—Ü–∏—è LLM + baseline
3. **Class weights** ‚Äî –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è recall –º–∏–Ω–æ—Ä–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
4. **–î—Ä—É–≥–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ generalization

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
wilds_experiment/
‚îú‚îÄ‚îÄ data/                          # –î–∞–Ω–Ω—ã–µ WILDS Amazon
‚îÇ   ‚îî‚îÄ‚îÄ amazon_v2.1/
‚îú‚îÄ‚îÄ .evaluation_cache/             # –ö—ç—à —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏ —Ä–∞–∑–±–∏–µ–Ω–∏–π
‚îú‚îÄ‚îÄ experiments_wilds/             # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ openevolve_output/         # –ü–æ—Å–ª–µ–¥–Ω–∏–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ openevolve_output_#1/      # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç #1
‚îÇ   ‚îú‚îÄ‚îÄ openevolve_output_#2/      # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç #2
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ baseline_output/               # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã baseline
‚îÇ   ‚îî‚îÄ‚îÄ results.json
‚îú‚îÄ‚îÄ templates/                     # –®–∞–±–ª–æ–Ω—ã –¥–ª—è —ç–≤–æ–ª—é—Ü–∏–∏
‚îú‚îÄ‚îÄ config.yaml                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è OpenEvolve
‚îú‚îÄ‚îÄ wilds_prompt.txt               # –ù–∞—á–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç
‚îú‚îÄ‚îÄ wilds_prompt_dataset.yaml      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îú‚îÄ‚îÄ evaluator.py                   # –û—Å–Ω–æ–≤–Ω–æ–π evaluator
‚îú‚îÄ‚îÄ baseline_embedding_pipeline.py # Baseline –ø–∞–π–ø–ª–∞–π–Ω
‚îú‚îÄ‚îÄ visualize_evolution.py         # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ analyze_improvements.py        # –ê–Ω–∞–ª–∏–∑ —É–ª—É—á—à–µ–Ω–∏–π
‚îú‚îÄ‚îÄ validate_best_prompt.py        # –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ run_evolution.ps1              # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ WILDS_EXPERIMENT_SUMMARY.md    # –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```powershell
# –î–∞—Ç–∞—Å–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
python analyze_dataset.py
```

### 2. –ó–∞–ø—É—Å–∫ baseline

```powershell
python baseline_embedding_pipeline.py --embedding roberta_sentiment --classifier xgb
```

### 3. –ó–∞–ø—É—Å–∫ —ç–≤–æ–ª—é—Ü–∏–∏

```powershell
.\run_evolution.ps1 -iterations 100
```

### 4. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```powershell
.\analyze_improvements.ps1
```

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: –Ø–Ω–≤–∞—Ä—å 2026*
*–í–µ—Ä—Å–∏—è: 2.0 (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)*



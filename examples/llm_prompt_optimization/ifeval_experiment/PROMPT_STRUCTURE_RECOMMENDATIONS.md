# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—é –ø—Ä–æ–º–ø—Ç–æ–≤: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ–∫—Ü–∏–∏

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–¢–∏–ø—ã —Å–µ–∫—Ü–∏–π –ø—Ä–æ–º–ø—Ç–æ–≤ –≤ LLM API](#—Ç–∏–ø—ã-—Å–µ–∫—Ü–∏–π-–ø—Ä–æ–º–ø—Ç–æ–≤-–≤-llm-api)
2. [–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ](#—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ)
3. [–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ](#—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ-—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ)
4. [–°–µ–∫—Ü–∏–∏ –¥–ª—è —ç–≤–æ–ª—é—Ü–∏–∏](#—Å–µ–∫—Ü–∏–∏-–¥–ª—è-—ç–≤–æ–ª—é—Ü–∏–∏)
5. [–ü—Ä–∏–º–µ—Ä—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤](#–ø—Ä–∏–º–µ—Ä—ã-—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö-–ø—Ä–æ–º–ø—Ç–æ–≤)
6. [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
7. [–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞](#–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞)

---

## –¢–∏–ø—ã —Å–µ–∫—Ü–∏–π –ø—Ä–æ–º–ø—Ç–æ–≤ –≤ LLM API

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ OpenAI/OpenRouter API

```python
messages = [
    {
        "role": "system",
        "content": "..."  # –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
    },
    {
        "role": "user",
        "content": "..."  # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç
    },
    {
        "role": "assistant",
        "content": "..."  # –û—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ (–¥–ª—è few-shot –∏–ª–∏ –¥–∏–∞–ª–æ–≥–æ–≤)
    }
]
```

### –¢–∏–ø—ã —Ä–æ–ª–µ–π –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

#### 1. **`system`** (–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–æ–ª—å, –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –º–æ–¥–µ–ª–∏
- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
  - –û–±—ã—á–Ω–æ **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π** –∏–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è —Ä–µ–¥–∫–æ
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç "–ª–∏—á–Ω–æ—Å—Ç—å" –º–æ–¥–µ–ª–∏
  - –ó–∞–¥–∞–µ—Ç –æ–±—â–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
  - –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä—ã:**
```
"You are a helpful assistant specialized in following complex instructions precisely."
"You are an expert at analyzing multi-paragraph texts and synthesizing information."
```

#### 2. **`user`** (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞ –∏–ª–∏ –∑–∞–ø—Ä–æ—Å
- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
  - –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ + –¥–∞–Ω–Ω—ã–µ
  - –û–±—ã—á–Ω–æ **—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç** –≤ prompt optimization
  - –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä—ã:**
```
"Answer the following question: {question}"
"Follow this instruction: {instruction}"
```

#### 3. **`assistant`** (–û—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: 
  - Few-shot –ø—Ä–∏–º–µ—Ä—ã (–ø–æ–∫–∞–∑ –∂–µ–ª–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞)
  - –î–∏–∞–ª–æ–≥–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
  - –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
  - –†–µ–¥–∫–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç (–æ–±—ã—á–Ω–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã)
  - –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è few-shot –æ–±—É—á–µ–Ω–∏—è

---

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

**–í evaluator.py:**
```python
# –í—Å–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ –æ–¥–∏–Ω user message
formatted_prompt = prompt.format(instruction=input_text)
messages = [{"role": "user", "content": formatted_prompt}]
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–º–ø—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞:**
```
Follow the instruction below carefully and precisely...

Instruction: {instruction}

Response:
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ system/user
- ‚ùå –í—Å—è –ª–æ–≥–∏–∫–∞ —Å–º–µ—à–∞–Ω–∞ –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–∞-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ—Å—Ç–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–†–∞–∑–¥–µ–ª–∏—Ç—å –ø—Ä–æ–º–ø—Ç –Ω–∞ **–¥–≤–µ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ–º—ã–µ —Å–µ–∫—Ü–∏–∏**:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SYSTEM PROMPT (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è)                        ‚îÇ
‚îÇ "You are an expert at following instructions..."        ‚îÇ
‚îÇ "Your role is to..."                                    ‚îÇ
‚îÇ "Always ensure that..."                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ USER PROMPT (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è)                          ‚îÇ
‚îÇ "Follow the instruction below precisely:"               ‚îÇ
‚îÇ "{instruction}"                                         ‚îÇ
‚îÇ "Provide your response in the format specified..."      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ CONTEXT/INPUT (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞)              ‚îÇ
‚îÇ - {instruction} –∏–∑ IFEval                               ‚îÇ
‚îÇ - {question} –∏–∑ HotpotQA                                ‚îÇ
‚îÇ - {context} –∏–∑ HotpotQA                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ

–î–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SYSTEM PROMPT (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è)                        ‚îÇ
‚îÇ - –†–æ–ª—å –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏                               ‚îÇ
‚îÇ - –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã                                 ‚îÇ
‚îÇ - –ú–µ—Ç–∞-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ USER PROMPT - Wrapper (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è)                ‚îÇ
‚îÇ - –û–±—Ä–∞–º–ª—è—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏                                ‚îÇ
‚îÇ - –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞                                         ‚îÇ
‚îÇ - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ USER PROMPT - Task Input (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)                ‚îÇ
‚îÇ - –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞                     ‚îÇ
‚îÇ - –í–æ–ø—Ä–æ—Å –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FEW-SHOT EXAMPLES (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è)       ‚îÇ
‚îÇ - –ü—Ä–∏–º–µ—Ä—ã –∂–µ–ª–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞                             ‚îÇ
‚îÇ - –®–∞–±–ª–æ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –°–µ–∫—Ü–∏–∏ –¥–ª—è —ç–≤–æ–ª—é—Ü–∏–∏

### ‚úÖ –°–µ–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ **—Å–ª–µ–¥—É–µ—Ç** —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å:

#### 1. **System Prompt** (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–ß—Ç–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è:**
- –†–æ–ª—å –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏
- –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã
- –ú–µ—Ç–∞-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–∫–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏)

**–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è IFEval:**
```yaml
# –í–µ—Ä—Å–∏—è 1 (–±–∞–∑–æ–≤–∞—è)
system: "You are a helpful assistant that follows instructions precisely."

# –í–µ—Ä—Å–∏—è 2 (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
system: |
  You are an expert at following complex, multi-constraint instructions.
  Your primary goal is to satisfy ALL specified requirements simultaneously.
  Pay close attention to formatting, length, and content constraints.
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ú–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å –æ–±—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞
- ‚úÖ –ú–æ–¥–µ–ª–∏ —á–∞—Å—Ç–æ –ª—É—á—à–µ —Å–ª–µ–¥—É—é—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ system prompt

---

#### 2. **User Prompt - Wrapper** (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–ß—Ç–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è:**
- –û–±—Ä–∞–º–ª—è—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤–æ–∫—Ä—É–≥ –∑–∞–¥–∞—á–∏
- –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞
- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è reasoning

**–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è IFEval:**
```yaml
# –í–µ—Ä—Å–∏—è 1 (–±–∞–∑–æ–≤–∞—è)
user_wrapper: |
  Follow the instruction below carefully and precisely.
  
  Instruction: {instruction}
  
  Response:

# –í–µ—Ä—Å–∏—è 2 (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
user_wrapper: |
  Read the instruction below. Identify all constraints and requirements.
  Ensure your response satisfies EVERY constraint mentioned.
  
  Step 1: Identify constraints (length, format, content, etc.)
  Step 2: Plan your response structure
  Step 3: Execute the instruction following all constraints
  
  Instruction: {instruction}
  
  Response:
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë–æ–ª–µ–µ –≥–∏–±–∫–∞—è, —á–µ–º system prompt
- ‚úÖ –ú–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —à–∞–≥–∏ reasoning
- ‚úÖ –õ–µ–≥—á–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏

---

#### 3. **Few-shot Examples** (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–ß—Ç–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è:**
- –ü—Ä–∏–º–µ—Ä—ã –∂–µ–ª–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
- –®–∞–±–ª–æ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä—ã:**
```yaml
few_shot_examples: |
  Example 1:
  Instruction: "Write exactly 5 sentences about cats."
  Response: "Cats are independent animals. They enjoy hunting small prey. Many people keep cats as pets. Cats have excellent night vision. Domestic cats are descendants of wild cats."

  Example 2:
  Instruction: "List 3 fruits without using commas."
  Response: "Apples Oranges Bananas"
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –û—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç—É
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚ö†Ô∏è –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞ (–±–æ–ª—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤)

---

### ‚ö†Ô∏è –°–µ–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ **–º–æ–∂–Ω–æ** —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é:

#### 4. **Output Format Specification** (–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–ß—Ç–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è:**
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –æ—Ç–≤–µ—Ç–∞
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã–≤–æ–¥–∞ (JSON, markdown, plain text)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è –∑–∞–¥–∞—á–∏
- –ï—Å–ª–∏ –º–æ–¥–µ–ª—å —á–∞—Å—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç

**–†–∏—Å–∫–∏:**
- –ú–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

---

### ‚ùå –°–µ–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ **–ù–ï —Å–ª–µ–¥—É–µ—Ç** —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å:

#### 1. **Task Input (–∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞)**

**–ß—Ç–æ –ù–ï —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è:**
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–∑ IFEval: `{instruction}`
- –í–æ–ø—Ä–æ—Å –∏–∑ HotpotQA: `{question}`
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ HotpotQA: `{context}`

**–ü—Ä–∏—á–∏–Ω–∞:**
- ‚úÖ –≠—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏, –Ω–µ –ø—Ä–æ–º–ø—Ç
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö = –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
- ‚úÖ –î–æ–ª–∂–Ω–æ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º –¥–ª—è —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–π –æ—Ü–µ–Ω–∫–∏

---

#### 2. **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏**

**–ß—Ç–æ –ù–ï —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è:**
- API-specific –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ (–µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã)

---

## –ü—Ä–∏–º–µ—Ä—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤

### –ü—Ä–∏–º–µ—Ä 1: IFEval —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ `ifeval_prompt_structured.yaml`:

```yaml
# –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è)
system: |
  You are an expert at following complex, multi-constraint instructions.
  Your role is to interpret and execute instructions while satisfying ALL
  specified requirements simultaneously, including length, format, content,
  and structural constraints.

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç - –æ–±—ë—Ä—Ç–∫–∞ (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è)
user_wrapper: |
  Read the instruction below carefully. Identify all constraints and requirements.
  
  Before responding:
  1. Identify all constraints (word count, sentence count, format, etc.)
  2. Check for forbidden words or required keywords
  3. Plan your response to satisfy ALL constraints
  
  Instruction:
  {instruction}
  
  Response:

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: few-shot –ø—Ä–∏–º–µ—Ä—ã (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è)
few_shot_examples: null  # –∏–ª–∏ —Ç–µ–∫—Å—Ç —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
```

#### –ö–∞–∫ —ç—Ç–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è:

```python
messages = []

# System prompt
if system_prompt:
    messages.append({"role": "system", "content": system_prompt})

# User prompt = wrapper + task input
user_content = user_wrapper.format(instruction=instruction_from_dataset)
if few_shot_examples:
    user_content = few_shot_examples + "\n\n" + user_content

messages.append({"role": "user", "content": user_content})
```

---

### –ü—Ä–∏–º–µ—Ä 2: HotpotQA —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º

```yaml
system: |
  You are an expert at multi-hop reasoning and information synthesis.
  Your role is to analyze multiple paragraphs, identify relevant information,
  and synthesize answers that require connecting information from different sources.

user_wrapper: |
  Analyze the provided context paragraphs. The question requires reasoning
  across multiple paragraphs to find the answer.
  
  Steps:
  1. Read each paragraph carefully
  2. Identify which paragraphs contain relevant information
  3. Connect information from different paragraphs
  4. Synthesize a clear, concise answer
  
  Context:
  {context}
  
  Question: {question}
  
  Answer:
```

---

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –®–∞–≥ 1: –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –ø—Ä–æ–º–ø—Ç–∞

**–í–º–µ—Å—Ç–æ `ifeval_prompt.txt`:**
```
Follow the instruction below carefully and precisely.
Instruction: {instruction}
Response:
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ifeval_prompt_structured.yaml`:**
```yaml
# –§–æ—Ä–º–∞—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
version: "1.0"

# –°–µ–∫—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–∞
sections:
  system:
    enabled: true
    content: |
      You are an expert at following complex instructions...
    evolvable: true  # –≠–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è –ª–∏ —ç—Ç–∞ —Å–µ–∫—Ü–∏—è
  
  user_wrapper:
    enabled: true
    content: |
      Follow the instruction below:
      {instruction}
      Response:
    evolvable: true
  
  few_shot_examples:
    enabled: false
    content: null
    evolvable: true

# –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
metadata:
  task: "ifeval"
  description: "Instruction following evaluation"
```

---

### –®–∞–≥ 2: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è evaluator.py

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
formatted_prompt = prompt.format(instruction=input_text)
messages = [{"role": "user", "content": formatted_prompt}]
```

**–ù–æ–≤—ã–π –∫–æ–¥:**
```python
def build_messages_from_structured_prompt(prompt_structure, task_input, config):
    """
    –°—Ç—Ä–æ–∏—Ç messages –¥–ª—è LLM –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞.
    
    Args:
        prompt_structure: Dict —Å —Å–µ–∫—Ü–∏—è–º–∏ –ø—Ä–æ–º–ø—Ç–∞
        task_input: Dict —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞–¥–∞—á–∏ (instruction, question, context)
        config: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞
    
    Returns:
        List[Dict] messages –¥–ª—è OpenAI API
    """
    messages = []
    
    # 1. System prompt
    if prompt_structure.get("system", {}).get("enabled", False):
        system_content = prompt_structure["system"]["content"]
        if system_content:
            messages.append({
                "role": "system",
                "content": system_content
            })
    
    # 2. User prompt
    user_parts = []
    
    # 2a. Few-shot examples (–µ—Å–ª–∏ –µ—Å—Ç—å)
    if prompt_structure.get("few_shot_examples", {}).get("enabled", False):
        few_shot = prompt_structure["few_shot_examples"]["content"]
        if few_shot:
            user_parts.append(few_shot)
    
    # 2b. User wrapper —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞–¥–∞—á–∏
    user_wrapper = prompt_structure["user_wrapper"]["content"]
    
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º wrapper —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞
    if config.get("is_ifeval"):
        user_content = user_wrapper.format(instruction=task_input["instruction"])
    elif config.get("is_hotpotqa"):
        user_content = user_wrapper.format(
            context=task_input.get("context", ""),
            question=task_input["question"]
        )
    # ... –¥—Ä—É–≥–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã
    
    user_parts.append(user_content)
    
    # –û–±—ä–µ–¥–∏–Ω—è–µ–º —á–∞—Å—Ç–∏ user prompt
    messages.append({
        "role": "user",
        "content": "\n\n".join(user_parts)
    })
    
    return messages
```

---

### –®–∞–≥ 3: –≠–≤–æ–ª—é—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤

**OpenEvolve –¥–æ–ª–∂–µ–Ω —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å:**
- ‚úÖ System prompt (–µ—Å–ª–∏ `evolvable: true`)
- ‚úÖ User wrapper (–µ—Å–ª–∏ `evolvable: true`)
- ‚úÖ Few-shot examples (–µ—Å–ª–∏ `evolvable: true`)

**OpenEvolve –ù–ï –¥–æ–ª–∂–µ–Ω —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å:**
- ‚ùå Task input (`{instruction}`, `{question}`, `{context}`)
- ‚ùå –°—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–∞ (YAML —Ñ–æ—Ä–º–∞—Ç)

**–ü—Ä–∏–º–µ—Ä —ç–≤–æ–ª—é—Ü–∏–∏:**

**–ò—Ç–µ—Ä–∞—Ü–∏—è 1:**
```yaml
system:
  content: "You are a helpful assistant."
user_wrapper:
  content: "Follow: {instruction}"
```

**–ò—Ç–µ—Ä–∞—Ü–∏—è 50 (—ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π):**
```yaml
system:
  content: |
    You are an expert at following multi-constraint instructions.
    Always verify all constraints before responding.
user_wrapper:
  content: |
    Analyze constraints:
    1. Length requirements
    2. Format requirements
    3. Content requirements
    
    Instruction: {instruction}
    
    Response:
```

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. **–ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**

```
System Prompt:    "–ö—Ç–æ —Ç—ã –∏ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å"
User Wrapper:     "–ö–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É"
Task Input:       "–ß—Ç–æ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å"
```

### 2. **–ë–æ–ª–µ–µ –≥–∏–±–∫–∞—è —ç–≤–æ–ª—é—Ü–∏—è**

- –ú–æ–∂–Ω–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å system –∏ user –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- –ú–æ–∂–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è–º–∏
- –õ–µ–≥—á–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫–∞—è —Å–µ–∫—Ü–∏—è –±–æ–ª—å—à–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### 3. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º**

- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ system prompt –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–∞-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è few-shot –ø—Ä–∏–º–µ—Ä–æ–≤

### 4. **–õ—É—á—à–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª—å—é**

–ú–æ–¥–µ–ª–∏ —á–∞—Å—Ç–æ:
- –õ—É—á—à–µ —Å–ª–µ–¥—É—é—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ system prompt
- –†–∞–∑–ª–∏—á–∞—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç (system) –∏ –∑–∞–¥–∞—á—É (user)
- –ë–æ–ª–µ–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ –≤–µ–¥—É—Ç —Å–µ–±—è —Å —á–µ—Ç–∫–∏–º system prompt

### 5. **–ê–Ω–∞–ª–∏–∑ –∏ –æ—Ç–ª–∞–¥–∫–∞**

- –õ–µ–≥—á–µ –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∞—è —Å–µ–∫—Ü–∏—è –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ú–æ–∂–Ω–æ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ system prompts
- –ú–æ–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ few-shot –ø—Ä–∏–º–µ—Ä–æ–≤

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –≠—Ç–∞–ø 1: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–æ–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
   - –ï—Å–ª–∏ —Ñ–∞–π–ª `.yaml` —Å —Å–µ–∫—Ü–∏—è–º–∏ ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
   - –ï—Å–ª–∏ —Ñ–∞–π–ª `.txt` ‚Üí —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (–≤—Å–µ –≤ user message)

2. **–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç:**
   ```python
   # –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç ‚Üí –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
   old_prompt = "Follow: {instruction}"
   
   new_structure = {
       "system": {"enabled": False, "content": None},
       "user_wrapper": {"enabled": True, "content": old_prompt},
       "few_shot_examples": {"enabled": False, "content": None}
   }
   ```

### –≠—Ç–∞–ø 2: –ë–∞–∑–æ–≤–∞—è —ç–≤–æ–ª—é—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤

1. **–≠–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å user_wrapper** (–∫–∞–∫ —Å–µ–π—á–∞—Å)
2. **System prompt - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π** (–Ω–µ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∫–∞)
3. **Few-shot - –æ—Ç–∫–ª—é—á–µ–Ω** (–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ)

### –≠—Ç–∞–ø 3: –ü–æ–ª–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π

1. **–≠–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å system prompt**
2. **–≠–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å user_wrapper**
3. **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å few-shot –ø—Ä–∏–º–µ—Ä—ã**

---

## –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

### IFEval

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```yaml
system: |
  You are an expert at following complex, multi-constraint instructions.
  Your goal is to satisfy ALL specified requirements simultaneously.

user_wrapper: |
  Identify all constraints in the instruction below:
  - Length constraints (words, sentences, paragraphs)
  - Format constraints (structure, formatting)
  - Content constraints (keywords, forbidden words)
  
  Instruction: {instruction}
  
  Ensure your response satisfies EVERY constraint.
  
  Response:

few_shot_examples: null  # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ
```

**–ß—Ç–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å:**
- ‚úÖ System prompt (–≤–∞–∂–Ω–æ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
- ‚úÖ User wrapper (–æ—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å —ç–≤–æ–ª—é—Ü–∏–∏)
- ‚ö†Ô∏è Few-shot (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å, –Ω–æ —É–≤–µ–ª–∏—á–∏—Ç —Ç–æ–∫–µ–Ω—ã)

---

### HotpotQA

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```yaml
system: |
  You are an expert at multi-hop reasoning. Your role is to analyze
  multiple information sources and synthesize coherent answers.

user_wrapper: |
  Read the context paragraphs below. The question requires connecting
  information from multiple paragraphs.
  
  Analysis steps:
  1. Identify relevant paragraphs
  2. Extract key information from each
  3. Connect information across paragraphs
  4. Synthesize a clear answer
  
  Context:
  {context}
  
  Question: {question}
  
  Answer:

few_shot_examples: null
```

**–ß—Ç–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å:**
- ‚úÖ System prompt (reasoning strategies)
- ‚úÖ User wrapper (analysis steps, format)
- ‚ö†Ô∏è Few-shot (–º–æ–∂–µ—Ç –ø–æ–º–æ—á—å, –Ω–æ –¥–æ—Ä–æ–≥–æ)

---

### HoVer

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```yaml
system: |
  You are an expert at claim verification. Your role is to analyze
  claims against provided evidence and determine support status.

user_wrapper: |
  Analyze the claim below against the provided evidence paragraphs.
  
  Steps:
  1. Identify the claim's main assertion
  2. Review evidence paragraphs for support or contradiction
  3. Determine if evidence SUPPORTS or DOES NOT SUPPORT the claim
  4. Provide your verdict: SUPPORTED or NOT_SUPPORTED
  
  Claim: {claim}
  Evidence: {evidence}
  
  Verdict:

few_shot_examples: |
  Example 1:
  Claim: "Paris is the capital of France."
  Evidence: "Paris is the largest city in France and serves as its capital."
  Verdict: SUPPORTED
  
  Example 2:
  Claim: "Dogs can fly."
  Evidence: "Dogs are mammals that walk on four legs."
  Verdict: NOT_SUPPORTED
```

**–ß—Ç–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å:**
- ‚úÖ System prompt
- ‚úÖ User wrapper
- ‚úÖ Few-shot (–≤–∞–∂–Ω–æ –¥–ª—è HoVer - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç –≤–µ—Ä–¥–∏–∫—Ç–∞)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–µ–∫—Ü–∏–∏ –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:

1. **System Prompt** (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ä–æ–ª—å –º–æ–¥–µ–ª–∏
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –æ–±—â–µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å

2. **User Wrapper** (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - –û–±—Ä–∞–º–ª—è—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤–æ–∫—Ä—É–≥ –∑–∞–¥–∞—á–∏
   - –û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å —Ç–µ–∫—É—â–µ–π —ç–≤–æ–ª—é—Ü–∏–∏
   - –û—Å—Ç–∞–µ—Ç—Å—è –≥–ª–∞–≤–Ω–æ–π —Å–µ–∫—Ü–∏–µ–π –¥–ª—è —ç–≤–æ–ª—é—Ü–∏–∏

3. **Few-shot Examples** (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç—É
   - –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞—á —Å —á–µ—Ç–∫–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º (HoVer, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)

### ‚ùå –°–µ–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï —Å–ª–µ–¥—É–µ—Ç —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å:

1. **Task Input** - –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
2. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** - –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è –∑–∞–¥–∞—á–∏

### üéØ –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:

1. **–≠—Ç–∞–ø 1**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (YAML) —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é
2. **–≠—Ç–∞–ø 2**: –≠–≤–æ–ª—é—Ü–∏—è user_wrapper (–∫–∞–∫ —Å–µ–π—á–∞—Å) + —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π system prompt
3. **–≠—Ç–∞–ø 3**: –≠–≤–æ–ª—é—Ü–∏—è system prompt + user_wrapper
4. **–≠—Ç–∞–ø 4**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - —ç–≤–æ–ª—é—Ü–∏—è few-shot –ø—Ä–∏–º–µ—Ä–æ–≤

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç:
- ‚úÖ –ë–æ–ª–µ–µ –≥–∏–±–∫—É—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —ç–≤–æ–ª—é—Ü–∏—é
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º —Ä–∞–±–æ—Ç—ã —Å LLM
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é –ø—Ä–æ–º–ø—Ç–æ–≤ –º–æ–¥–µ–ª—å—é
- ‚úÖ –õ—É—á—à–∏–π –∞–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —Å–µ–∫—Ü–∏–π –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

